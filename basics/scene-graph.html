
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>PixiJS: Scene Graph</title>
    <meta http-equiv="refresh" content="0; url=https://pixijs.com/guides/basics/scene-graph">


  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-103772589-9']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" />
    <link type="text/css" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.3/styles/googlecode.min.css">
    
      <meta name="og:title" content="PixiJS Guides" />
    
      <meta name="og:description" content="The holy guide for PixiJS developers" />
    
      <meta name="og:image" content="https://camo.githubusercontent.com/dd5f0c8ce84c09599ebd30c7a48076b3ca4ef7d1f36aed96c64952d3432942a1/68747470733a2f2f706978696a732e646f776e6c6f61642f706978696a732d62616e6e65722d6e6f2d76657273696f6e2e706e67" />
    
      <meta name="og:site" content="https://pixijs.io/guides/" />
    
      <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    
      <link rel="stylesheet" type="text/css" href="/guides/static/styles.css" />
    
  </head>
  <body class="root">
    <div class="docs tutorials">
      <article class="page">
        <div class="header-content-container">
          <section class="header" id="header-mount-point">
            

<div class="header__wrapper">
  <div class="header__container">
    <section class="explorer__header__title">
      <a href="https://www.pixijs.com" class="pixi-logo">
        PixiJS Guides
      </a>
    </section>
    <div class="header__contents">
      <section class="header__contents-main">
        
          
            <a
              class="header__link header__link--current"
              href="/guides/index.html"
            >
              Guides
            </a>
          
        
          
            <a
              class="header__link "
              href="https://github.com/pixijs/pixijs"
            >
              GitHub
            </a>
          
        
          
            <a
              class="header__link "
              href="https://pixijs.io/examples"
            >
              Examples
            </a>
          
        
          
            <a
              class="header__link "
              href="https://pixijs.io/docs"
            >
              API Docs
            </a>
          
        
          
            <a
              class="header__link "
              href="https://opencollective.com/pixijs"
            >
              Support Us
            </a>
          
        
      </section>
    </div>
  </div>
</div>

          </section>
          <div class="header-content-container__content">
            <div class="page-explorer" id="explorer-mount-point">
                

<div class="explorer-wrapper">
  <h3>Guides</h3>
  
<div class="explorer">
  <ul role="tree" class="explorer__tree explorer__tree-open">
    
      
        

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/index.html">
          Welcome
        </a>
      
    </div>
  </div>
  
</li>
      
    
      
        

<li class="explorer-tree__target explorer-tree__parent">
  
    <input type="checkbox" checked="true" />
  
  <div>
    <div>
      
         <svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true" width="24px" height="24px"><path d="M10 17l5-5-5-5v10z"></path></svg>
      
      
        <section>Basics</section>
      
    </div>
  </div>
  
    <ul role="group">
      <div>
        <div>
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/what-pixijs-is.html">
          What PixiJS Is
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/what-pixijs-is-not.html">
          What PixiJS Is Not
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/getting-started.html">
          Getting Started
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/architecture-overview.html">
          Architecture Overview
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/containers.html">
          Containers
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/display-object.html">
          Display Objects
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/textures.html">
          Textures
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/graphics.html">
          Graphics
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/interaction.html">
          Interaction
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/render-loop.html">
          Render Loop
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/scene-graph.html">
          Scene Graph
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/sprites.html">
          Sprites
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/sprite-sheets.html">
          Spritesheets
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/text.html">
          Text
        </a>
      
    </div>
  </div>
  
</li>
            
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/basics/assets.html">
          Assets
        </a>
      
    </div>
  </div>
  
</li>
            
          
        </div>
      </div>
    </ul>
  
</li>
      
    
      
        

<li class="explorer-tree__target explorer-tree__parent">
  
    <input type="checkbox" checked="true" />
  
  <div>
    <div>
      
         <svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true" width="24px" height="24px"><path d="M10 17l5-5-5-5v10z"></path></svg>
      
      
        <section>Production</section>
      
    </div>
  </div>
  
    <ul role="group">
      <div>
        <div>
          
            
              

<li class="explorer-tree__target ">
  
  <div>
    <div>
      
      
        <a href="/guides/production/performance-tips.html">
          Performance Tips
        </a>
      
    </div>
  </div>
  
</li>
            
          
        </div>
      </div>
    </ul>
  
</li>
      
    
  </ul>
</div>
</div>

            </div>
            
<main class="page-content">
  <a class="edit-link" href="https://github.com/pixijs/guides/edit/main/docs/basics/scene-graph.md">
    Edit Guide
  </a>
  <div class="document">
    
    <h1>PixiJS Guides</h1>
<h2>The Scene Graph</h2>
<p>Every frame, PixiJS is updating and then rendering the scene graph.  Let's talk about what's in the scene graph, and how it impacts how you develop your project.  If you've built games before, this should all sound very familiar, but if you're coming from HTML and the DOM, it's worth understanding before we get into specific types of objects you can render.</p>
<h2>The Scene Graph Is a Tree</h2>
<p>The scene graph's root node is a container maintained by the application, and referenced with <code>app.stage</code>.  When you add a sprite or other renderable object as a child to the stage, it's added to the scene graph and will be rendered and interactable.  Most PixiJS objects can also have children, and so as you build more complex scenes, you will end up with a tree of parent-child relationships, rooted at the app's stage.</p>
<p>(A helpful tool for exploring your project is the <a href="https://chrome.google.com/webstore/detail/pixijs-devtools/aamddddknhcagpehecnhphigffljadon">Pixi.js devtools plugin</a> for Chrome, which allows you to view and manipulate the scene graph in real time as it's running!)</p>
<h2>Parents and Children</h2>
<p>When a parent moves, its children move as well.  When a parent is rotated, its children are rotated too.  Hide a parent, and the children will also be hidden.  If you have a game object that's made up of multiple sprites, you can collect them under a container to treat them as a single object in the world, moving and rotating as one.</p>
<!--TODO: verify this - vaguely remember caching of e.g. transforms to prevent having to run tree each frame?-->
<p>Each frame, PixiJS runs through the scene graph from the root down through all the children to the leaves to calculate each object's final position, rotation, visibility, transparency, etc.  If a parent's alpha is set to 0.5 (making it 50% transparent), all its children will start at 50% transparent as well.  If a child is then set to 0.5 alpha, it won't be 50% transparent, it will be 0.5 x 0.5 = 0.25 alpha, or 75% transparent.  Similarly, an object's position is relative to its parent, so if a parent is set to an x position of 50 pixels, and the child is set to an x position of 100 pixels, it will be drawn at a screen offset of 150 pixels, or 50 + 100.</p>
<p>Here's an example.  We'll create three sprites, each a child of the last, and animate their position, rotation, scale and alpha.  Even though each sprite's properties are set to the same values, the parent-child chain amplifies each change:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Create the application helper and add its render target to the page</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> PIXI.Application({ <span class="hljs-attr">width</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">360</span> });
<span class="hljs-built_in">document</span>.body.appendChild(app.view);

<span class="hljs-comment">// Add a container to center our sprite stack on the page</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-keyword">new</span> PIXI.Container();
container.x = app.screen.width / <span class="hljs-number">2</span>;
container.y = app.screen.height / <span class="hljs-number">2</span>;
app.stage.addChild(container);

<span class="hljs-comment">// Create the 3 sprites, each a child of the last</span>
<span class="hljs-keyword">const</span> sprites = [];
<span class="hljs-keyword">let</span> parent = container;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  <span class="hljs-keyword">let</span> sprite = PIXI.Sprite.from(<span class="hljs-string">&#x27;assets/images/sample.png&#x27;</span>);
  sprite.anchor.set(<span class="hljs-number">0.5</span>);
  parent.addChild(sprite);
  sprites.push(sprite);
  parent = sprite;
}

<span class="hljs-comment">// Set all sprite&#x27;s properties to the same value, animated over time</span>
<span class="hljs-keyword">let</span> elapsed = <span class="hljs-number">0.0</span>;
app.ticker.add(<span class="hljs-function">(<span class="hljs-params">delta</span>) =&gt;</span> {
  elapsed += delta / <span class="hljs-number">60</span>;
  <span class="hljs-keyword">const</span> amount = <span class="hljs-built_in">Math</span>.sin(elapsed);
  <span class="hljs-keyword">const</span> scale = <span class="hljs-number">1.0</span> + <span class="hljs-number">0.25</span> * amount;
  <span class="hljs-keyword">const</span> alpha = <span class="hljs-number">0.75</span> + <span class="hljs-number">0.25</span> * amount;
  <span class="hljs-keyword">const</span> angle = <span class="hljs-number">40</span> * amount;
  <span class="hljs-keyword">const</span> x = <span class="hljs-number">75</span> * amount;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; sprites.length; i++) {
    <span class="hljs-keyword">const</span> sprite = sprites[i];
    sprite.scale.set(scale);
    sprite.alpha = alpha;
    sprite.angle = angle;
    sprite.x = x;
  }
});
</code></pre>
<p>The cumulative translation, rotation, scale and skew of any given node in the scene graph is stored in the object's <code>worldTransform</code> property.  Similarly, the cumulative alpha value is stored in the <code>worldAlpha</code> property.</p>
<h2>Render Order</h2>
<p>So we have a tree of things to draw.  Who gets drawn first?</p>
<p>PixiJS renders the tree from the root down.  At each level, the current object is rendered, then each child is rendered in order of insertion.  So the second child is rendered on top of the first child, and the third over the second.</p>
<p>Check out this example, with two parent objects A &amp; D, and two children B &amp; C under A:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Create the application helper and add its render target to the page</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> PIXI.Application({ <span class="hljs-attr">width</span>: <span class="hljs-number">640</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">360</span> });
<span class="hljs-built_in">document</span>.body.appendChild(app.view);

<span class="hljs-comment">// Label showing scene graph hierarchy</span>
<span class="hljs-keyword">const</span> label = <span class="hljs-keyword">new</span> PIXI.Text(<span class="hljs-string">&#x27;Scene Graph:\n\napp.stage\n  ┗ A\n     ┗ B\n     ┗ C\n  ┗ D&#x27;</span>, {<span class="hljs-attr">fill</span>: <span class="hljs-string">&#x27;#ffffff&#x27;</span>});
label.position = {<span class="hljs-attr">x</span>: <span class="hljs-number">300</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>};
app.stage.addChild(label);

<span class="hljs-comment">// Helper function to create a block of color with a letter</span>
<span class="hljs-keyword">const</span> letters = [];
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLetter</span>(<span class="hljs-params">letter, parent, color, pos</span>) </span>{
  <span class="hljs-keyword">const</span> bg = <span class="hljs-keyword">new</span> PIXI.Sprite(PIXI.Texture.WHITE);
  bg.width = <span class="hljs-number">100</span>;
  bg.height = <span class="hljs-number">100</span>;
  bg.tint = color;

  <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">new</span> PIXI.Text(letter, {<span class="hljs-attr">fill</span>: <span class="hljs-string">&quot;#ffffff&quot;</span>});
  text.anchor.set(<span class="hljs-number">0.5</span>);
  text.position = {<span class="hljs-attr">x</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">50</span>};

  <span class="hljs-keyword">const</span> container = <span class="hljs-keyword">new</span> PIXI.Container();
  container.position = pos;
  container.visible = <span class="hljs-literal">false</span>;
  container.addChild(bg, text);
  parent.addChild(container);

  letters.push(container);
  <span class="hljs-keyword">return</span> container;
}

<span class="hljs-comment">// Define 4 letters</span>
<span class="hljs-keyword">let</span> a = addLetter(<span class="hljs-string">&#x27;A&#x27;</span>, app.stage, <span class="hljs-number">0xff0000</span>, {<span class="hljs-attr">x</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>});
<span class="hljs-keyword">let</span> b = addLetter(<span class="hljs-string">&#x27;B&#x27;</span>, a,         <span class="hljs-number">0x00ff00</span>, {<span class="hljs-attr">x</span>: <span class="hljs-number">20</span>,  <span class="hljs-attr">y</span>: <span class="hljs-number">20</span>});
<span class="hljs-keyword">let</span> c = addLetter(<span class="hljs-string">&#x27;C&#x27;</span>, a,         <span class="hljs-number">0x0000ff</span>, {<span class="hljs-attr">x</span>: <span class="hljs-number">20</span>,  <span class="hljs-attr">y</span>: <span class="hljs-number">40</span>});
<span class="hljs-keyword">let</span> d = addLetter(<span class="hljs-string">&#x27;D&#x27;</span>, app.stage, <span class="hljs-number">0xff8800</span>, {<span class="hljs-attr">x</span>: <span class="hljs-number">140</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>});

<span class="hljs-comment">// Display them over time, in order</span>
<span class="hljs-keyword">let</span> elapsed = <span class="hljs-number">0.0</span>;
app.ticker.add(<span class="hljs-function">(<span class="hljs-params">delta</span>) =&gt;</span> {
  elapsed += delta / <span class="hljs-number">60.0</span>;
  <span class="hljs-keyword">if</span> (elapsed &gt;= letters.length) { elapsed = <span class="hljs-number">0.0</span>; }
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; letters.length; i ++) {
    letters[i].visible = elapsed &gt;= i;
  }
});
</code></pre>
<p>If you'd like to re-order a child object, you can use <code>setChildIndex()</code>.  To add a child at a given point in a parent's list, use <code>addChildAt()</code>.  Finally, you can enable automatic sorting of an object's children using the <code>sortableChildren</code> option combined with setting the <code>zIndex</code> property on each child.</p>
<h2>Culling</h2>
<p>If you're building a project where a large proportion of your DisplayObject's are off-screen (say, a side-scrolling game), you will want to <em>cull</em> those objects.  Culling is the process of evaluating if an object (or its children!) is on the screen, and if not, turning off rendering for it.  If you don't cull off-screen objects, the renderer will still draw them, even though none of their pixels end up on the screen.</p>
<p>PixiJS doesn't provide built-in support for viewport culling, but you can find 3rd party plugins that might fit your needs.  Alternately, if you'd like to build your own culling system, simply run your objects during each tick and set <code>renderable</code> to false on any object that doesn't need to be drawn.</p>
<h2>Local vs Global Coordinates</h2>
<p>If you add a sprite to the stage, by default it will show up in the top left corner of the screen.  That's the origin of the global coordinate space used by PixiJS.  If all your objects were children of the stage, that's the only coordinates you'd need to worry about.  But once you introduce containers and children, things get more complicated.  A child object at [50, 100] is 50 pixels right and 100 pixels down <em>from its parent</em>.</p>
<p>We call these two coordinate systems &quot;global&quot; and &quot;local&quot; coordinates.  When you use <code>position.set(x, y)</code> on an object, you're always working in local coordinates, relative to the object's parent.</p>
<p>The problem is, there are many times when you want to know the global position of an object.  For example, if you want to cull offscreen objects to save render time, you need to know if a given child is outside the view rectangle.</p>
<p>To convert from local to global coordinates, you use the <code>toGlobal()</code> function.  Here's a sample usage:</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Get the global position of an object, relative to the top-left of the screen</span>
<span class="hljs-keyword">let</span> globalPos = obj.toGlobal(<span class="hljs-keyword">new</span> PIXI.Point(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>));
</code></pre>
<p>This snippet will set <code>globalPos</code> to be the global coordinates for the child object, relative to [0, 0] in the global coordinate system.</p>
<h2>Global vs Screen Coordinates</h2>
<p>When your project is working with the host operating system or browser, there is a third coordinate system that comes into play - &quot;screen&quot; coordinates (aka &quot;viewport&quot; coordinates).  Screen coordinates represent position relative to the top-left of the canvas element that PixiJS is rendering into.  Things like the DOM and native mouse click events work in screen space.</p>
<p>Now, in many cases, screen space is equivalent to world space.  This is the case if the size of the canvas is the same as the size of the render view specified when you create you PIXI.Application.  By default, this will be the case - you'll create for example an 800x600 application window and add it to your HTML page, and it will stay that size.  100 pixels in world coordinates will equal 100 pixels in screen space.  BUT!  It is common to stretch the rendered view to have it fill the screen, or to render at a lower resolution and up-scale for speed.  In that case, the screen size of the canvas element will change (e.g. via CSS), but the underlying render view will <em>not</em>, resulting in a mis-match between world coordinates and screen coordinates.</p>
<!--TODO: best method to convert from world to screen coords?-->

  </div>
  
    <div class="serial-navigation both">
      
        <a class="serial-navigation-button previous" href="/guides/basics/render-loop.html">
          <svg
            class="arrow"
            version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            width="27px"
            height="14px"
            viewBox="0 0 23 14"
            xml:space="preserve"
          >
            <line x1="0" y1="7" x2="6" y2="1" />
            <line x1="0" y1="7" x2="6" y2="13" />
            <line x1="0" y1="7" x2="23" y2="7" />
          </svg>
          <span class="label">Previous Guide</span>
          <span class="title">Render Loop</span>
        </a>
      
      
        <hr />
      
      
        <a class="serial-navigation-button next" href="/guides/basics/sprites.html">
          <svg
            class="arrow"
            version="1.1" xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            x="0px"
            y="0px"
            width="27px"
            height="14px"
            viewBox="0 0 23 14"
            xml:space="preserve"
          >
            <line x1="22" y1="7" x2="16" y2="1" />
            <line x1="22" y1="7" x2="16" y2="13" />
            <line x1="0" y1="7" x2="23" y2="7" />
          </svg>
          <span class="label">Next Guide</span>
          <span class="title">Sprites</span>
        </a>
      
    </div>
  
  


  <footer class="footer" id="footer-mount-point"></footer>

</main>
          </div>
          <div class="bottom-banner">
              <div class="bottom-banner-content">
  <div class="authors">
    <a href="https://www.pixijs.com" target="_blank" class="pixi-logo">
      PixiJS Logo
    </a>
    <section>
      &copy; 2023 PixiJS. All Rights Reserved.
    </section>
    <section>
      A labor of love by Rob Morris <a href="https://github.com/irongaze">@irongaze</a>,
      Shukant Pal <a href="https://twitter.com/shukantp">@ShukantP</a> and the
      <a href="https://github.com/orgs/pixijs/people">PixiJS team</a>.
    </section>
  </div>
</div>

          </div>
        </div>
      </article>
    </body>
  </div>
  
    <script src="/guides/static/main.js"></script>
  
</html>
